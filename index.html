<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dating app</title>
    <style>
    body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
}

/*#card { 
}*/

    #overview {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
      }

      .popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 20px;
        background: white;
        border: 2px solid #ccc;
        border-radius: 10px;
        z-index: 1;
      }
      .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1;
      }
    </style>
</head>
<body>
<div id="score"></div>
 <div id="card"></div>
 <div id="overview"></div>

 <div class="overlay" id="overlay"></div> <!-- Overlay for popup vindu -->

    <div class="popup" id="editPopup"> <!-- Popup vindu for redigering av bruker -->
      <label for="newName">Navn:</label> <!-- Redigering av navn -->
      <input type="text" id="newName" /> <!-- Input felt for nytt navn -->
      <br />
      <label for="newAge">Alder:</label> <!-- Redigering av alder -->
      <input type="text" id="newAge" /> <!-- Input felt for ny alder -->
      <br />
      <label for="newPlace">Land:</label> <!-- Redigering av land -->
      <input type="text" id="newPlace" /> <!-- Input felt for nytt land -->         
      <br />

      <button onclick="saveChanges()">Lagre endringer</button> <!-- Knapp for å lagre endringer -->
      <button onclick="closePopup()">Avbryt</button> <!-- Knapp for å avbryte endringer -->
    </div> <!-- Deklarerer en div tag -->
    
<button onclick="filter"('male')>Søk menn</button>
<button onclick="filter"('female')>Søk kvinne</button>
<button onclick="filter"('both')>Søk begge</button>


    
    <script>
let score = 10;
let genderFilter ="";
let currentProfile = null;d
//let likedProfiles = JSON.parse(localStorage.getItem("likedProfiles")) ||[];

document.addEventListener("keydown", function (event) {
    if (event.key === "ArrowLeft") {
        swipe("left");
    } else if (event.key === "ArrowRight") {
        swipe("right");
    }
});

let likedProfiles =
        JSON.parse(localStorage.getItem("likedProfiles")) || [];

document.addEventListener("DOMContentLoaded", function() {
    updateOverview();
});

//Henter inn tilfeldig brukerprofil gjennom API basert på valgte filter i linken, i slutten linken ligger det en string genderFilter som skal filtrere resultatet på kjønn. Link 2 er uten kjønnsfiltrering. 
function fetchRandomProfile(){
const url = genderFilter
? `https://randomuser.me/api/?inc=gender,name,location,pictures,dob&gender,${genderFilter}`
: "https://randomuser.me/api/?inc=gender,name,location,pictures,dob";

fetch(url)
.then((response) => response.json())
.then((data) => {
    currentProfile = data.results[0];

    displayProfile();
})
.catch((error) => consol.error("Feil med henting av tilfeldig profil:", error))
}



//Oppretter filter gender(kjønn) og kaller på fetchRandomProfile
function filter(gender){
    genderFilter = gender
    fetchRandomProfile();
}



//funksjon for framvisning av kort på siden, henter in variabler div"card.
// oppdaterer koden med html koden som skal vise profilinformasjonen.
function displayProfile() {
const card = document.getElementById("card");
card.innerHTML = `
<img src="${currentProfile.pictures.large}" alt="Profile Pictures"
<p>Navn: ${currentProfile.name.first}</p>
<p>Alder: ${currentProfile.dob.age}</p>
<p>Land: ${currentProfile.location.country}</p>
`
}

function swipe(direction) {
    while (score <= 0) {
        const answer = prompt("Vil du swipe mer? Ja/Nei");

        if (answer.toLowerCase() === "ja") {
            score = 10;
            updateScore();
        } else if (answer.toLowerCase() === "nei") {
            continue;
        } else {
            alert("Du må skrive ja i neste felt for å fortsette med swipingen");
            continue;
        }
    }

    if (likedProfiles.length >= 10) {
        alert("Oversiktslisten er full. Slett en profil for å swipe igjen");
        return;
    }

    if (direction === "right") {
       likedProfiles.push(currentProfile);
       localStorage.setItem("likedProfiles", JSON.stringify(likedProfiles));
       updateOverview();
    }
    fetchRandomProfile();
    score--;
    displayProfile();
    updateScore();
}

function updateScore() {
    const scoreElement = document.getElementById("score");
    scoreElement.textContent = `Score: ${score}`;
}

function updateOverview(){
overview.innerHTML ="";
likedProfiles.forEach((profile) =>{
    const card = document.createElement("div");
    card.classList = profile.gender;
    card.innerHTML = `
    <img src="${profile.pictures.large}" alt="Profile Pictures"
<p>Navn: ${profile.name.first}</p>
<p>Alder: ${profile.dob.age}</p>
<p>Land: ${profile.location.country}</p>
<button onclick="deleteProfile('${profile.name.first}')">Slett</button>
<button onclick="editProfile('${profile.name.first}', '${profile.dob.age}','${profile.location.country}')">Endre</button>
    `;
    overview.appendChild(card);
});
}

function deleteProfile(name) { //Funksjon for å slette profil
        likedProfiles = likedProfiles.filter( //Filtrerer ut profilen som skal slettes
            (profile) => profile.name.first !== name //Sjekker om navnet på profilen er likt navnet som er valgt
        );//Lagrer endringene i localStorage
        localStorage.setItem("likedProfiles", JSON.stringify(likedProfiles)); //Oppdaterer oversikten
        updateOverview(); //Oppdaterer scoren
      }


    </script>
</body>
</html>

